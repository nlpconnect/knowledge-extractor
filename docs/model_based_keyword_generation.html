---

title: Title


keywords: fastai
sidebar: home_sidebar



nb_path: "nbs/00_model_based_keyword_generation.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/00_model_based_keyword_generation.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>None of PyTorch, TensorFlow &gt;= 2.0, or Flax have been found. Models won&#39;t be available and only tokenizers, configuration and file/data utilities can be used.
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="BartKeywordGenerator" class="doc_header"><code>class</code> <code>BartKeywordGenerator</code><a href="https://github.com/ankur3107/knowledge_extractor/tree/master/knowledge_extractor/keyword_generators.py#L9" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>BartKeywordGenerator</code>(<strong><code>model_name</code></strong>, <strong><code>use_cuda</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Bart based keyword generator using huggingface transformers</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="/knowledge_extractor/model_based_keyword_generation.html#BartKeywordGenerator"><code>BartKeywordGenerator</code></a> is a base class for keyword generator. It is implemented based on huggingface transformer lib.</p>
<p>It has two function:</p>
<ol>
<li><code>generate()</code>: Given text input it will generate keywords. The parameters are based on transformers .generate arguments. </li>
<li><code>batch_generate()</code>: Given a list of text inputs. Firstly it will split into batches and then generate.</li>
</ol>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="ExtractiveKeywordGenerator" class="doc_header"><code>class</code> <code>ExtractiveKeywordGenerator</code><a href="https://github.com/ankur3107/knowledge_extractor/tree/master/knowledge_extractor/keyword_generators.py#L40" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>ExtractiveKeywordGenerator</code>(<strong><code>use_cuda</code></strong>=<em><code>False</code></em>) :: <a href="/knowledge_extractor/model_based_keyword_generation.html#BartKeywordGenerator"><code>BartKeywordGenerator</code></a></p>
</blockquote>
<p>It will generate extractive keywords using bart based fined tunned model on openkp datasets</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="/knowledge_extractor/model_based_keyword_generation.html#ExtractiveKeywordGenerator"><code>ExtractiveKeywordGenerator</code></a> implements <a href="/knowledge_extractor/model_based_keyword_generation.html#BartKeywordGenerator"><code>BartKeywordGenerator</code></a> for extractive keyword generator</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="AbstractiveKeywordGenerator" class="doc_header"><code>class</code> <code>AbstractiveKeywordGenerator</code><a href="https://github.com/ankur3107/knowledge_extractor/tree/master/knowledge_extractor/keyword_generators.py#L47" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>AbstractiveKeywordGenerator</code>(<strong><code>use_cuda</code></strong>=<em><code>False</code></em>) :: <a href="/knowledge_extractor/model_based_keyword_generation.html#BartKeywordGenerator"><code>BartKeywordGenerator</code></a></p>
</blockquote>
<p>It will generate abstractive keywords using bart based fined tunned model on kpTimes dataset</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="/knowledge_extractor/model_based_keyword_generation.html#AbstractiveKeywordGenerator"><code>AbstractiveKeywordGenerator</code></a> implements <a href="/knowledge_extractor/model_based_keyword_generation.html#BartKeywordGenerator"><code>BartKeywordGenerator</code></a> for abstractive keyword generator</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">extractive_generator</span> <span class="o">=</span> <span class="n">ExtractiveKeywordGenerator</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Some weights of the PyTorch model were not used when initializing the TF 2.0 model TFBartForConditionalGeneration: [&#39;lm_head.weight&#39;]
- This IS expected if you are initializing TFBartForConditionalGeneration from a PyTorch model trained on another task or with another architecture (e.g. initializing a TFBertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing TFBartForConditionalGeneration from a PyTorch model that you expect to be exactly identical (e.g. initializing a TFBertForSequenceClassification model from a BertForSequenceClassification model).
All the weights of TFBartForConditionalGeneration were initialized from the PyTorch model.
If your task is similar to the task the model of the checkpoint was trained on, you can already use TFBartForConditionalGeneration for predictions without further training.
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">abstractive_generator</span> <span class="o">=</span> <span class="n">AbstractiveKeywordGenerator</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Some weights of the PyTorch model were not used when initializing the TF 2.0 model TFBartForConditionalGeneration: [&#39;lm_head.weight&#39;]
- This IS expected if you are initializing TFBartForConditionalGeneration from a PyTorch model trained on another task or with another architecture (e.g. initializing a TFBertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing TFBartForConditionalGeneration from a PyTorch model that you expect to be exactly identical (e.g. initializing a TFBertForSequenceClassification model from a BertForSequenceClassification model).
All the weights of TFBartForConditionalGeneration were initialized from the PyTorch model.
If your task is similar to the task the model of the checkpoint was trained on, you can already use TFBartForConditionalGeneration for predictions without further training.
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">extractive_generator</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">input_text</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[{&#39;keywords&#39;: [&#39;The death toll in Germany&#39;, &#39; Belgium&#39;, &#39; historic flood&#39;]}]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">extractive_generator</span><span class="o">.</span><span class="n">batch_generate</span><span class="p">([</span><span class="n">input_text</span><span class="p">,</span> <span class="n">input_text</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[{&#39;keywords&#39;: [&#39;The death toll in Germany&#39;, &#39; Belgium&#39;, &#39; historic flood&#39;]},
 {&#39;keywords&#39;: [&#39;The death toll in Germany&#39;, &#39; Belgium&#39;, &#39; historic flood&#39;]}]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">abstractive_generator</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">input_text</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[{&#39;keywords&#39;: [&#39;Floods&#39;, &#39;Germany&#39;, &#39;Belgium&#39;, &#39;Europe&#39;]}]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">extractive_generator</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">input_text</span><span class="p">,</span> <span class="n">min_length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">num_beams</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> 
    <span class="n">early_stopping</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[{&#39;keywords&#39;: [&#39;The death toll in Germany&#39;, &#39; Belgium&#39;, &#39; historic flood&#39;]}]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">extractive_generator</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">input_text</span><span class="p">,</span> <span class="n">do_sample</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">top_k</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[{&#39;keywords&#39;: [&#39;The death toll in Germany&#39;, &#39; Belgium&#39;, &#39; historic flood&#39;]}]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

